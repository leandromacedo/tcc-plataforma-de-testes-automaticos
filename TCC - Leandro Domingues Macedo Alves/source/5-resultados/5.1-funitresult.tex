\hypertarget{fence-unit-test-resultados}{%
\section{Verificação de código com testes unitários}\label{fence-unit-test-resultados}}

Até o momento atual, 291 testes unitários foram desenvolvidos em 3 repositórios do grupo de programadores, sendo estes \emph{Fence}, \emph{Atlas} e \emph{Alice}. Estes \emph{test cases} contém 310 asserções que cobrem 64 métodos de 29 classes. O \emph{FUnit} foi desenvolvido há 6 meses atrás, e desde então mais de 100 testes foram desenvolvidos utilizando o \emph{framework}, em uma média de quase 20 testes por mês. A expectativa é que taxa de desenvolvimento cresça no futuro. Isso se deve principalmente ao tempo necessário para ambientação e aprendizado dos desenvolvedores com a nova proposta de testes.

Por causa da ausência da prática de testes unitários no passado, a cobertura atual de testes em toda a base de código é considerada baixa. Por exemplo no repositório \emph{Fence}, há uma cobertura de apenas 9.2\%, com apenas 2 mil linhas cobertas das 22 mil existentes. Entretanto este número vem crescendo, e os desenvolvimentos recentes no repositório costumam ter uma média de 60\% de cobertura de testes. Fica clara a necessidade do grupo consolidar o hábito de desenvolver testes unitários em paralelo com o desenvolvimento em código. Isso poderia ser inclusive mais aperfeiçoado no futuro com a prática de \emph{TDD}, escrevendo antecipadamente o teste antes do próprio código.

Em relação ao desempenho de execução destes testes, ao longo dos últimos 4 meses a integração contínua executou os testes unitários entre os diferentes repositórios em um total de mais de 900 vezes, com 87\% de taxa de sucesso. Em 8,5\% das vezes foram detectados erros, evitando em mais de 70 vezes a propagação de inconsistências para o ambiente de produção. Esse número pode ser ainda maior se for considerada as ocasiões em que os desenvolvedores executaram os testes unitários em suas próprias máquinas durante o desenvolvimento.

Em média cada execução de todos os testes unitários de um repositório leva em média 2,8 segundos para ser executada em apenas uma máquina, tendo sido no total executados mais de 140 mil \emph{test cases} ao longo de aproximadamente 45 minutos nas \emph{pipelines}. Estes dados mostram o custo extremamente baixo exigido pelos testes unitários, de forma que não prejudicam o processo de entregas rápidas.

Para trabalhos futuros há inicialmente o interesse em aperfeiçoar o \emph{FUnit} com um melhor suporte a testes de integração. Atualmente é possível a realização destes testes, mas há oportunidades para otimização, como a criação de abstrações para facilitar testes em \emph{REST API}. Em relação a testes unitários, algumas funcionalidades extras poderiam ser desenvolvidas no futuro. Por exemplo, é desejável ter a possibilidade de múltiplas condições de entrada para um único \emph{test case}, de forma que possa ser executado repetidamente para cada condição. Seria interessante também o \emph{framework} ter capacidade de desenvolver \emph{mocks} adicionais além do tradicional \emph{mock} que representa a própria classe a ser testada, algo que é especialmente útil para métodos que fazem chamadas a outras instâncias de classe. Outro ideia é a extensão de testes unitários para além da linguagem \emph{php}, estendendo a implementação dos testes para a linguagem \emph{javascript}.
